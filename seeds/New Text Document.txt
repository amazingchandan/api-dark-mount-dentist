const mongoose = require("mongoose");
const Users = require('../models/users');
const bcrypt = require('bcryptjs');

mongoose.connect('mongodb://localhost/ati_vendor_management', {}).then(() => { 
    console.log('MONGO CONNECTION OPEN!!!');
}).catch((err) => { 
    console.log(err);
});


const createSuperadminSeed = async () => {
    try {
      const dataBody = {
        firstName: 'ATI',
        lastName: 'Admin',
        email: 'ati@yopmail.com',
        password: 'Ati@12345',
      }
      const hashedPassword = await bcrypt.hash('Ati@12345', 12);
      dataBody.password = hashedPassword;
      const isAlreadyExist = await Users.findOne({email: dataBody.email});
     
      if (!isAlreadyExist) {
        const addSuperadmin = await new Users(dataBody).save();
        if (!addSuperadmin) {
          throw new Error("Not able to add user");
        } else {
          console.log("User created successfully");
        }
      } else {
        throw new Error("User email already exists");
      }
    } catch (err) {
      console.error(err);
    }
  }

  createSuperadminSeed().then(() => {
  
  })